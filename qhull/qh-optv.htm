<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title>Qhull options: Delauany and Voronoi</title>
</head>

<body>
<!-- Navigation links -->
<p><b>Up:</b> <a href="http://www.geom.umn.edu/locate/qhull">Home
page for Qhull</a> <br>
<b>Up:</b> <a href="qh-man.htm#TOC">Qhull manual: Table of
Contents</a> <br>
<b>Up:</b> <a href="qh-opt.htm">Qhull options</a></p>

<p><b>To:</b> <a href="qh-man.htm#synopsis">Synopsis</a> &#149; <a
href="qh-opt.htm#opt">Main</a> &#149; <a
href="qh-opto.htm#output">Output</a> &#149; <a
href="qh-optf.htm#format">Formats</a> &#149; <a
href="qh-optg.htm#geomview">Geomview</a> &#149; <a
href="qh-optp.htm#print">Print</a> &#149; <a
href="qh-optq.htm#qhull">Qhull</a> &#149; <a
href="qh-optc.htm#prec">Precision</a> &#149; <a
href="qh-optt.htm#trace">Trace</a></p>

<hr>
<!-- Main text of document -->
<h1><a
href="http://www.geom.umn.edu/graphics/pix/Special_Topics/Computational_Geometry/delaunay.html"><img
src="qh--dt.gif" alt="[delaunay]" align="middle" width="100"
height="100"></a> Qhull options: Delaunay and Voronoi</h1>

<p>This section lists the options for Delaunay triangulations,
Voronoi diagrams, furthest-site Delaunay
triangulations, and furthest-site Voronoi diagrams. </p>

<p>Qhull computes these structures as convex hulls. This makes
the conventions and options confusing. Each structure is
introduced with a representative example. You can use the same
options with your application. Experiment with the other options
as you need them. </p>

<p><b>Copyright  1995-1998 The Geometry Center, Minneapolis MN</b></p>

<hr>

<h2><a href="qh-opt.htm#opt"></a><a name="d">Delaunay
triangulation ('d')</a></h2>

<p>The Delaunay triangulation is the triangulation with empty
circumspheres. It has many useful properties and applications.
See the survey article by Aurenhammer [<a
href="qh-man.htm#aure91">'91</a>] and the detailed introduction
by O'Rourke [<a href="qh-man.htm#orou94">'94</a>]. </p>

<dl>
    <dt><b>Example:</b> rbox 10 D2 | qhull d <a
        href="qh-optq.htm#QJn">QJ</a> <a href="qh-opto.htm#s">s</a>
        <a href="qh-opto.htm#i">i</a> <a href="qh-optt.htm#TO">TO
        result</a></dt>
    <dd>Compute the 2-d Delaunay triangulation of 10 random
        points. Joggle the input to guarantee triangular output.
        Write a summary to the console and the triangles to
        'result'.</dd>
</dl>

<p>Qhull computes the Delaunay triangulation by computing a
convex hull. It lifts the input sites to a paraboloid by adding
the sum of the squares of the coordinates. It computes the convex
hull of the lifted sites, and projects the lower convex hull to
the input. Each triangle of the Delaunay triangulation
corresponds to a facet of the lower half of the convex hull.
Facets of the upper half of the convex hull correspond to the <a
href="qh-optv.htm#dQu">furthest-site Delaunay triangulation</a>.
See the examples, <a href="qh-eg.htm#delaunay">Delaunay and
Voronoi diagrams</a>.</p>

<p>Most users should use 'qhull d <a href="qh-optq.htm#QJn">QJ</a>'
or 'qhull d <a href="qh-optq.htm#Qbb">Qbb</a>'. If you do not use
'QJ', the output may include merged facets due to cocircular or
cospherical input sites. If you use 'QJ', duplicate points will
create small triangles. Without 'QJ', the output will report
nearly incident input sites. See <a href="qh-impre.htm#joggle">Joggled
input or merged facets</a>'. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="d-conventions"><font
size="4">Delaunay conventions</font></a></h3>

<p>The following terminology is used for Delaunay triangulations
in Qhull for dimension <i>d</i>. The underlying structure is the
lower facets of a convex hull in dimension <i>d+1</i>. For
further information, see <a href="qh-man.htm#structure">data
structures</a> and <a href="qh-opt.htm#conventions">convex hull
conventions</a>.</p>

<ul>
    <li><em>input site</em> - a point in the input (one dimension
        lower than a point on the convex hull)</li>
    <li><em>point</em> - <i>d+1</i> coordinates. The last
        coordinate is the sum of the squares of the input site's
        coordinates</li>
    <li><em>coplanar point</em> - a <em>nearly incident</em>
        input site</li>
    <li><em>vertex</em> - a point on the paraboloid. It
        corresponds to a unique input site. </li>
    <li><em>point-at-infinity</em> - a point added above the
        paraboloid by option '<a href="qh-optq.htm#Qz">Qz</a>'</li>
    <li><em>lower facet</em> - a facet corresponding to a
        Delaunay triangle. The last coefficient of its normal is
        negative.</li>
    <li><em>upper facet</em> - a facet corresponding to a
        furthest-site Delaunay triangle. The last coefficient of
        its normal is positive. </li>
    <li><em>Delaunay facet</em> - a lower facet projected to the
        input sites</li>
    <li><em>upper Delaunay facet</em> - an upper facet projected
        to the input sites</li>
    <li><em>non-simplicial facet</em> - more than <em>d</em>
        input sites are cocircular or cospherical</li>
    <li><em>good facet</em> - a Delaunay facet with optional
        restrictions by '<a href="qh-optq.htm#QVn">QVn</a>', etc.</li>
</ul>

<h3><a href="qh-opt.htm#opt"></a><a name="d-outputs">Delaunay
outputs</a></h3>

<p>These options control the output of Delaunay triangulations:</p>

<dl compact>
    <dt>&nbsp;</dt>
    <dd><b>General</b></dd>
    <dt><a href="qh-optf.htm#FA">FA</a></dt>
    <dd>compute total area for '<a href="qh-opto.htm#s">s</a>'
        and '<a href="qh-optf.htm#FS">FS</a>'</dd>
    <dt><a href="qh-opto.htm#o">o</a></dt>
    <dd>print lower facets of the corresponding convex hull (a
        paraboloid)</dd>
    <dt><a href="qh-opto.htm#s">s</a></dt>
    <dd>print summary for the Delaunay triangulation. Use '<a
        href="qh-optf.htm#Fs">Fs</a>' for the numbers.</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Delaunay facets</b></dd>
    <dt><a href="qh-opto.htm#i">i</a></dt>
    <dd>list input sites for each Delaunay facet</dd>
    <dt><a href="qh-optf.htm#Fv">Fv</a></dt>
    <dd>list input sites for each Delaunay facet</dd>
    <dt><a href="qh-optf.htm#Fn">Fn</a></dt>
    <dd>list neighboring facets for each Delaunay facet</dd>
    <dt><a href="qh-optf.htm#FN">FN</a></dt>
    <dd>list neighboring facets for each input site</dd>
    <dt><a href="qh-optf.htm#Fa">Fa</a></dt>
    <dd>print area for each Delaunay facet</dd>
    <dt><a href="qh-optf.htm#Ft">Ft</a></dt>
    <dd>print coordinates of the input sites and any added
        points. Then list the input sites for each Delaunay
        triangle</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Input sites</b></dd>
    <dt><a href="qh-optf.htm#Fx">Fx</a></dt>
    <dd>list extreme points of the input sites</dd>
    <dt><a href="qh-optq.htm#Qc">Qc</a> <a href="qh-optf.htm#Fc">Fc</a></dt>
    <dd>list nearly incident input sites for each Delaunay facet
        (one facet per input site)</dd>
    <dt><a href="qh-optq.htm#Qc">Qc</a> <a href="qh-optf.htm#FP">FP</a></dt>
    <dd>print nearly incident input sites with distance to
        nearest unique input site (i.e., vertex)</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a><a name="d-controls">Delaunay
controls</a></h3>

<p>These options provide additional control:</p>

<dl compact>
    <dt><a href="qh-optq.htm#Qz">Qz</a></dt>
    <dd>add a point above the paraboloid to reduce precision
        errors. Use it for nearly cocircular/cospherical input
        (e.g., 'rbox c | qhull d Qz'). The point is printed for
        options '<a href="qh-optf.htm#Ft">Ft</a>' and '<a
        href="qh-opto.htm#o">o</a>'.</dd>
    <dt><a href="qh-optp.htm#PDk">PDk:1</a></dt>
    <dd>include upper and lower facets in the output (<i>k</i> is
        the last dimension) </dd>
    <dt><a href="qh-optq.htm#QJn">QJ</a></dt>
    <dd>joggle the input and set '<a href="qh-optq.htm#Qbb">Qbb</a>'
    </dd>
    <dt><a href="qh-opto.htm#f">f</a></dt>
    <dd>print the data structure for each facet</dd>
    <dt><a href="qh-optt.htm#TFn">TFn</a></dt>
    <dd>report progress after constructing <em>n</em> facets</dd>
    <dt><a href="qh-optq.htm#Qbb">Qbb</a></dt>
    <dd>scale the last coordinate to reduce precision errors. Use
        it for integer coefficients and nearly
        cocircular/cospherical input.</dd>
    <dt><a href="qh-optq.htm#QVn">QVn</a> <a
        href="qh-optp.htm#Pg">Pg</a></dt>
    <dd>select facets adjacent to input site <em>n</em> (marked
        'good')</dd>
    <dt><a href="qh-optt.htm#Tv">Tv</a></dt>
    <dd>verify result</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a><a name="d-graphics">Delaunay
graphics</a></h3>

<p>For 2-d and 3-d Delaunay triangulations, Geomview ('qhull d <a
href="qh-optg.htm#G">G</a>') displays the corresponding convex
hull (a paraboloid). </p>

<p>To get a 2-d Delaunay triangulation, use 'qhull d <a
href="qh-optg.htm#GDn">GrD2</a>' to drop the last dimension. This
is the same as viewing the hull without perspective (see
Geomview's 'cameras' menu). </p>

<p>To get a 3-d Delaunay triangulation, use 'qhull d <a
href="qh-optg.htm#GDn">GrD3</a>' to drop the last dimension. You
may see extra edges. These are interior edges that Geomview moves
towards the viewer (see 'lines closer' in Geomview's camera
options). Use option '<a href="qh-optg.htm#Gt">Gt</a>' to make
the outer ridges transparent in 3-d. See <a
href="qh-eg.htm#delaunay">Delaunay and Voronoi examples</a>.</p>

<p>For 2-d Delaunay triangulations, Mathematica ('<a
href="qh-opto.htm#m">m</a>') displays the corresponding convex
hull (a paraboloid). </p>

<h3><a href="qh-opt.htm#opt"></a><a name="d-notes">Delaunay
notes</a></h3>

<p>A non-simplicial facet indicates nearly cocircular or
cospherical input sites. To avoid non-simplicial facets joggle
the input with '<a href="qh-optq.htm#QJn">QJ</a>' or use option '<a
href="qh-optf.htm#Ft">Ft</a>' to print a triangulation. It adds
points for non-simplicial facets. You can use an <a
href="qh-impre.htm#exact">exact arithmetic code</a>.</p>

<p>To compute the Delaunay triangulation of points on a sphere,
compute their convex hull. If the sphere is the unit sphere at
the origin, the facet normals are the Voronoi vertices of the
input. The points may be restricted to a hemisphere. [S. Fortune]
</p>

<p>With the <a href="qh-man.htm#library">Qhull library</a>, you
can use qh_findbestfacet in <tt>poly2.c</tt> to locate the facet
that contains a point. You should first lift the point to the
paraboloid (i.e., the last coordinate is the sum of the squares
of the point's coordinates -- qh_setdelaunay). Do not use options
'<a href="qh-optq.htm#Qbb">Qbb</a>', '<a href="qh-optq.htm#QbB">QbB</a>',
'<a href="qh-optq.htm#Qbk">Qbk:n</a>', or '<a
href="qh-optq.htm#QBk">QBk:n</a>' since these scale the last
coordinate. </p>

<p>If a point is interior to the convex hull of the input set, it
is interior to the adjacent vertices of the Delaunay
triangulation. This is demonstrated by the following pipe for
point 0: </p>

<blockquote>
    <p>qhull &lt;data d s FQ QV0 Pg p | qhull s Qb3:0B3:0 p </p>
</blockquote>

<p>The first call to Qhull returns the neighboring points of
point 0 in the Delaunay triangulation. The second call to Qhull
returns the vertices of the convex hull of these points (after
dropping the lifted coordinate). If point 0 is interior to the
original point set, it is interior to the reduced point set. </p>

<h2><a href="qh-opt.htm#opt"></a><a name="v">Voronoi diagram ('v')</a></h2>

<p>The Voronoi diagram is the nearest-neighbor map for a set of
points. It has many useful properties and applications. See the
survey article by Aurenhammer [<a href="qh-man.htm#aure91">'91</a>]
and the detailed introduction by O'Rourke [<a
href="qh-man.htm#orou94">'94</a>]. The Voronoi diagram is the
dual of the Delaunay triangulation. </p>

<dl>
    <dt><b>Example:</b> rbox 10 D3 | qhull v <a
        href="qh-optq.htm#QJn">QJ</a> <a href="qh-opto.htm#s">s</a>
        <a href="qh-opto.htm#o">o</a> <a href="qh-optt.htm#TO">TO
        result</a></dt>
    <dd>Compute the 3-d Voronoi diagram of 10 random points.
        Joggle the input to guarantee triangular output. Write a
        summary to the console and the Voronoi vertices and regions
        to 'result'. The first vertex of the result
        indicates unbounded regions.</dd>
</dl>

<p>Qhull computes the Voronoi diagram via the Delaunay
triangulation ('<a href="qh-optv.htm#d">d</a>'). Each Voronoi
vertex is the circumcenter of a facet of the Delaunay
triangulation. Each Voronoi region corresponds to a vertex of the
Delaunay triangulation (i.e., an input site). </p>

<p>Qhull outputs the Voronoi vertices for each Voronoi region
(i.e., each input point).  With option '<a href="qh-optf.htm#Fv2">Fv</a>'),
it lists all ridges of the Voronoi diagram with the corresponding
pair of input sites.  You can also output a single Voronoi region
for further processing by Qhull [<a href="#v-graphics">graphics</a>].</p>

<p>Most users should use 'qhull v <a href="qh-optq.htm#QJn">QJ</a>'
or 'qhull v <a href="qh-optq.htm#Qbb">Qbb</a>'. If you do not use
'QJ', the output may include merged facets due to cocircular or
cospherical input sites. If you use 'QJ', duplicate points will
create small triangles. Without 'QJ', the output will report
nearly incident input sites. See <a href="qh-impre.htm#joggle">Joggled
input or merged facets</a>'. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="v-conventions"><font
size="4">Voronoi conventions</font></a></h3>

<p>The following terminology is used for Voronoi diagrams in
Qhull. The underlying structure is a Delaunay triangulation from
a convex hull in one higher dimension. Facets of the Delaunay
triangulation correspond to vertices of the Voronoi diagram.
Vertices of the Delaunay triangulation correspond to input sites.
They also correspond to regions of the Voronoi diagram. See <a
href="qh-opt.htm#conventions">convex hull conventions</a> and <a
href="#d-conventions">Delaunay conventions</a>.</p>

<ul>
    <li><em>input site</em> - a point in the input (one dimension
        lower than a point on the convex hull)</li>
    <li><em>point</em> - <i>d+1</i> coordinates. The last
        coordinate is the sum of the squares of the input site's
        coordinates</li>
    <li><em>coplanar point</em> - a <em>nearly incident</em>
        input site</li>
    <li><em>vertex</em> - a point on the paraboloid. It
        corresponds to a unique input site. </li>
    <li><em>point-at-infinity</em> - a point added above the
        paraboloid by option '<a href="qh-optq.htm#Qz">Qz</a>'</li>
    <li><em>Delaunay facet</em> - a lower facet of the
        paraboloid. It is projected to the input sites</li>
    <li><em>Voronoi vertex</em> - the circumcenter of a Delaunay
        facet</li>
    <li><em>Voronoi region</em> - the Voronoi vertices for an
        input site. The region of Euclidean space nearest to an
        input site.</li>
    <li><em>Voronoi diagram</em> - the graph of the Voronoi
        regions. It includes the ridges (i.e., edges) between the
        regions.</li>
    <li><em>infinity vertex</em> - the Voronoi vertex that
        indicates unbounded Voronoi regions in '<a
        href="qh-opto.htm#o">o</a>' output format. Its
        coordinates are <em>-10.101</em>.</li>
    <li><em>good facet</em> - a Delaunay facet with optional
        restrictions by '<a href="qh-optq.htm#QVn">QVn</a>', etc.</li>
</ul>

<h3><a href="qh-opt.htm#opt"></a> <a name="v-outputs">Voronoi
outputs</a></h3>

<p>These options control the output of Voronoi diagrams.  Other 
output options return the corresponding Delaunay
triangulation.</p>

<dl compact>
    <dt>&nbsp;</dt>
    <dd><b>General</b></dd>
    <dt><a href="qh-opto.htm#s">s</a></dt>
    <dd>print summary of the Voronoi diagram. Use '<a
        href="qh-optf.htm#Fs">Fs</a>' for the numbers.</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Voronoi vertices</b></dd>
    <dt><a href="qh-optf.htm#Fv2">Fv</a></dt>
    <dd>list ridges of Voronoi vertices for pairs of input sites.</dd>
    <dt><a href="qh-optf.htm#Fn">Fn</a></dt>
    <dd>list the neighboring Voronoi vertices for each Voronoi
        vertex</dd>
    <dt><a href="qh-optf.htm#FN">FN</a></dt>
    <dd>list the Voronoi vertices for each Voronoi region</dd>
    <dt><a href="qh-opto.htm#p">p</a></dt>
    <dd>print the coordinates of the Voronoi vertices.</dd>
    <dt><a href="#FC">FC</a></dt>
    <dd>print Voronoi vertex ("center") for each facet</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Voronoi regions</b></dd>
    <dt><a href="qh-opto.htm#i">i</a></dt>
    <dd>list the Voronoi regions for each Voronoi vertex</dd>
    <dt><a href="qh-opto.htm#o">o</a></dt>
    <dd>print coordinates of the Voronoi vertices and list
        the vertices for each input site. In 2-d, this is the
        Voronoi diagram without the unbounded rays.</dd>
    <dt><a href="#Fi2">Fi</a></dt>
    <dd>print separating hyperplanes for inner, bounded Voronoi regions</dd>
    <dt><a href="#Fo2">Fo</a></dt>
    <dd>print separating hyperplanes for outer, unbounded Voronoi regions</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Input sites</b></dd>
    <dt><a href="qh-optf.htm#Fv2">Fv</a></dt>
    <dd>list the adjacent input sites and the corresponding ridge of the 
         Voronoi diagram.</dd>
    <dt><a href="qh-optq.htm#Qc">Qc</a> <a href="qh-optf.htm#FP">FP</a></dt>
    <dd>print nearly incident points with distance to nearest
        input site</dd>
    <dt><a href="qh-optq.htm#QVn">QVn</a> <a
        href="qh-optp.htm#Pg">Pg</a></dt>
    <dd>select Voronoi vertices for input site <em>n</em> </dd>
</dl>

<p>For the '<a href="qh-opto.htm#o">o</a>' option, the first
number is the dimension. The next two numbers are the number of
vertices and the number of input sites. The line ends with a
&quot;1&quot;. The Voronoi vertices are listed one per line. The
first (<em>0</em>'th) vertex indicates the infinity vertex. Its
coordinates are <em>-10.101</em>. The infinity vertex also occurs
for degenerate Delaunay triangles.</p>

<p>The Voronoi regions follow the vertices with one line per
input site. Each region is defined by the number of Voronoi
vertices followed by the index of each vertex. Coplanar input
sites have &quot;0&quot; vertices. In 2-d, the vertices are
listed in adjacency order (unoriented). In 3-d and higher, the
vertices are listed in numeric order. A zero index indicates the
infinity vertex. Such regions are unbounded. If you use option '<a
href="qh-optq.htm#Qz">Qz</a>', the last line will be the Voronoi
region for the point-at-infinity (a single &quot;0&quot;).</p>

<p>For the '<a href="qh-optf.htm#Fv2">Fv</a>' option, the first
line is the number of ridges.  The remaining lines list the number
of indices, a pair of input sites, and the corresponding ridge of
the Voronoi diagram.  Vertex 0 indicates an unbounded ray.

<h3><a href="qh-opt.htm#opt"></a> <a name="v-controls">Voronoi
controls</a></h3>

<p>These options provide additional control:</p>

<dl compact>
    <dt><a href="qh-optq.htm#Qz">Qz</a></dt>
    <dd>add a point above the paraboloid to reduce precision
        errors. Use it for nearly cocircular/cospherical input
        (e.g., 'rbox c | qhull v Qz').</dd>
    <dt><a href="qh-optq.htm#QJn">QJ</a></dt>
    <dd>joggle the input and set '<a href="qh-optq.htm#Qbb">Qbb</a>'
    </dd>
    <dt><a href="qh-opto.htm#f">f </a></dt>
    <dd>print the data structure for each facet</dd>
    <dt><a href="qh-optt.htm#TFn">TFn</a></dt>
    <dd>report progress after constructing <em>n</em> facets</dd>
    <dt><a href="qh-optq.htm#Qbb">Qbb</a></dt>
    <dd>scale the last coordinate to reduce precision errors. Use
        it for integer coefficients and nearly
        cocircular/cospherical input.</dd>
    <dt><a href="qh-optt.htm#Tv">Tv</a></dt>
    <dd>verify result</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a> <a name="v-graphics">Voronoi
graphics</a></h3>

<p>In 2-d, Geomview output ('<a href="qh-optg.htm#G">G</a>')
displays a Voronoi diagram with extra edges to close the
unbounded Voronoi regions. To view the unbounded rays, enclose
the input points in a square.</p>

<p>You can also view <i>individual</i> Voronoi regions in 3-d. To
view the Voronoi region for site 3 in Geomview, execute</p>

<blockquote>
    <p>qhull &lt;data v '<a href="qh-optq.htm#QVn">QV3</a>' '<a
    href="qh-opto.htm#p">p</a>' '<a href="qh-optp.htm#Pg">Pg</a>'
    | qhull s G &gt;output</p>
</blockquote>

<p>The first <tt>qhull</tt> command returns the Voronoi vertices
for all facets incident to point 3 in the Delaunay triangulation.
The second <tt>qhull</tt> command computes their convex hull.
This is the Voronoi region for input site 3. </p>

<p>See the <a href="qh-eg.htm#delaunay">Delaunay and Voronoi
examples</a> for 2-d and 3-d examples. Turn off normalization (on
Geomview's 'obscure' menu) when comparing the Voronoi diagram
with the corresponding Delaunay triangulation. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="v-notes">Voronoi
notes</a></h3>

<p>You can simplify the Voronoi diagram by enclosing the input sites
in a large square or cube.

<p>See <a href="#v-graphics">Voronoi graphics</a> for computing
the convex hull of a Voronoi region. </p>

<p>Unbounded regions can be confusing.  
For example, '<tt>rbox c | qhull v Qz o</tt>' produces
the Voronoi regions for the vertices of a cube centered at the
origin. All regions are unbounded. The output is </p>

<blockquote>
    <pre>3
2 9 1
-10.101 -10.101 -10.101 
     0      0      0 
2 0 1
2 0 1
2 0 1
2 0 1
2 0 1
2 0 1
2 0 1
2 0 1
0
</pre>
</blockquote>

<p>The first line is the dimension. The second line is the number
of vertices and the number of regions. There is one region per
input point plus a region for the point-at-infinity added by
option '<a href="qh-optq.htm#Qz">Qz</a>'. The next two lines
lists the Voronoi vertices. The first vertex is the infinity
vertex. It is indicate by the coordinates <em>-10.101</em>. The
second vertex is the origin. The next nine lines list the
regions. Each region lists two vertices -- the infinity vertex
and the origin. The last line is &quot;0&quot; because no region
is associated with the point-at-infinity. A &quot;0&quot; would
also be listed for nearly incident input sites. </p>

To use option '<a href="qh-optf.htm#Fv">Fv</a>', add an interior
point.  For example,
<blockquote>
<pre>
rbox c P0 | qhull v Fv
20
5 0 7 1 3 5
5 0 3 1 4 5
5 0 5 1 2 3
5 0 1 1 2 4
5 0 6 2 3 6
5 0 2 2 4 6
5 0 4 4 5 6
5 0 8 5 3 6
5 1 2 0 2 4
5 1 3 0 1 4
5 1 5 0 1 2
5 2 4 0 4 6
5 2 6 0 2 6
5 3 4 0 4 5
5 3 7 0 1 5
5 4 8 0 6 5
5 5 6 0 2 3
5 5 7 0 1 3
5 6 8 0 6 3
5 7 8 0 3 5
</pre>
</blockquote>
The output consists of 20 ridges and each ridge lists
a pair of input sites and a triplet of Voronoi vertices.  The first
eight ridges connect the origin ('P0').  The remainder list
the edges of the cube.  Each edge generates an unbounded
ray through the midpoint.  The corresponding separating planes ('Fo')
follow each pair of coordinate axes.

<h2><a href="qh-opt.htm#opt"></a><a name="dQu">Furthest-site
Delaunay triangulation ('d Qu') </a></h2>

<p>The furthest-site Delaunay triangulation is dual of the <a
href="qh-optv.htm#vQu">furthest-site Voronoi diagram</a>. It
corresponds to the upper Delaunay facets of the Delaunay
construction ('<a href="qh-optv.htm#d">d</a>').</p>

<dl>
    <dt><b>Example:</b> rbox 10 D2 | qhull d Qu <a
        href="qh-optq.htm#QJn">QJ</a> <a href="qh-opto.htm#s">s</a>
        <a href="qh-opto.htm#i">i</a> <a href="qh-optt.htm#TO">TO
        result</a></dt>
    <dd>Compute the 2-d, furthest-site Delaunay triangulation of
        10 random points. Joggle the input to guarantee
        triangular output. Write a summary to the console and the
        triangles to 'result'.</dd>
</dl>

<p>Most users should use 'qhull d Qu <a href="qh-optq.htm#QJn">QJ</a>'
or 'qhull d Qu <a href="qh-optq.htm#Qbb">Qbb</a>'. If you do not
use 'QJ', the output may include merged facets due to cocircular
or cospherical input sites. If you use 'QJ', duplicate points
will create small triangles. Without 'QJ', the output will report
nearly incident input sites. See <a href="qh-impre.htm#joggle">Joggled
input or merged facets</a>'. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="dQu-conventions"><font
size="4">furthest-site Delaunay conventions</font></a></h3>

<p>The following terminology is used for furthest-site Delaunay
triangulations in Qhull. The underlying structure is the upper
facets of a convex hull in one higher dimension. See <a
href="qh-opt.htm#conventions">convex hull conventions</a> and <a
href="qh-optv.htm#d-conventions">Delaunay conventions</a>.</p>

<ul>
    <li><em>input site</em> - a point in the input (one dimension
        lower than a point on the convex hull)</li>
    <li><em>point</em> - <i>d+1</i> coordinates. The last
        coordinate is the sum of the squares of the input site's
        coordinates</li>
    <li><em>coplanar point</em> - a <em>nearly incident</em>
        input site</li>
    <li><em>vertex</em> - a point on the paraboloid. It
        corresponds to a unique input site. </li>
    <li><em>upper facet</em> - a facet with a positive last
        coefficient for the hyperplane</li>
    <li><em>upper Delaunay facet</em> - an upper facet projected
        to the input sites</li>
    <li><em>non-simplicial facet</em> - more than <em>d</em>
        points are cocircular or cospherical</li>
    <li><em>good facet</em> - a Delaunay facet with optional
        restrictions by '<a href="qh-optq.htm#QVn">QVn</a>', etc.</li>
</ul>

<h3><a href="qh-opt.htm#opt"></a><a name="dQu-outputs">furthest-site
Delaunay outputs</a></h3>

<p>These options control the output of furthest-site Delaunay
triangulations:</p>

<dl compact>
    <dt>&nbsp;</dt>
    <dd><b>General</b></dd>
    <dt><a href="qh-optf.htm#FA">FA</a></dt>
    <dd>compute total area for '<a href="qh-opto.htm#s">s</a>'
        and '<a href="qh-optf.htm#FS">FS</a>'</dd>
    <dt><a href="qh-opto.htm#o">o</a></dt>
    <dd>print upper facets of the corresponding convex hull</dd>
    <dt><a href="qh-opto.htm#s">s</a></dt>
    <dd>print summary for the furthest-site Delaunay
        triangulation. Use '<a href="qh-optf.htm#Fs">Fs</a>' for
        the numbers.</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>furthest-site Delaunay facets</b></dd>
    <dt><a href="qh-opto.htm#i">i</a></dt>
    <dd>list the input sites for each furthest-site Delaunay
        facet</dd>
    <dt><a href="qh-optf.htm#Fv">Fv</a></dt>
    <dd>list input sites for each furthest-site Delaunay facet</dd>
    <dt><a href="qh-optf.htm#FN">FN</a></dt>
    <dd>list neighboring facets for each input site</dd>
    <dt><a href="qh-optf.htm#Fn">Fn</a></dt>
    <dd>list neighboring facets for each furthest-site Delaunay
        facet</dd>
    <dt><a href="qh-optf.htm#Fa">Fa</a></dt>
    <dd>print area for each furthest-site Delaunay facet</dd>
    <dt><a href="qh-optf.htm#Ft">Ft</a></dt>
    <dd>print coordinates of the input sites and any added
        points. Then list the input sites for each furthest-site
        Delaunay triangle</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>Input sites</b></dd>
    <dt><a href="qh-optf.htm#Fx">Fx</a></dt>
    <dd>list extreme points of the input sites</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a><a name="dQu-controls">furthest-site
Delaunay controls</a></h3>

<p>These options provide additional control:</p>

<dl compact>
    <dt><a href="qh-optp.htm#PDk">PDk:1</a></dt>
    <dd>include upper and lower facets in the output (<i>k</i> is
        the last dimension) </dd>
    <dt><a href="qh-optq.htm#QJn">QJ</a></dt>
    <dd>joggle the input and set '<a href="qh-optq.htm#Qbb">Qbb</a>'
    </dd>
    <dt><a href="qh-opto.htm#f">f </a></dt>
    <dd>print the data structure for each facet</dd>
    <dt><a href="qh-optt.htm#TFn">TFn</a></dt>
    <dd>report progress after constructing <em>n</em> facets</dd>
    <dt><a href="qh-optq.htm#Qbb">Qbb</a></dt>
    <dd>scale the last coordinate to reduce precision errors. Use
        it for integer coefficients and nearly
        cocircular/cospherical input.</dd>
    <dt><a href="qh-optq.htm#QVn">QVn</a> <a
        href="qh-optp.htm#Pg">Pg</a></dt>
    <dd>select facets adjacent to input site <em>n</em> (marked
        'good')</dd>
    <dt><a href="qh-optt.htm#Tv">Tv</a></dt>
    <dd>verify result</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a><a name="dQu-graphics">furthest-site
Delaunay graphics</a></h3>

<p>For 2-d and 3-d furthest-site Delaunay triangulations,
Geomview ('qhull d Qu <a href="qh-optg.htm#G">G</a>') displays
the corresponding convex hull (a paraboloid). </p>

<p>To get a 2-d furthest-site Delaunay triangulation, use 'qhull
d Qu <a href="qh-optg.htm#GDn">GrD2</a>' to drop the last
dimension. This is the same as viewing the hull without
perspective (see Geomview's 'cameras' menu). </p>

<p>To get a 3-d furthest-site Delaunay triangulation, use 'qhull
d Qu <a href="qh-optg.htm#GDn">GrD3</a>' to drop the last
dimension. You may see extra edges. These are interior edges that
Geomview moves towards the viewer (see 'lines closer' in
Geomview's camera options). Use option '<a href="qh-optg.htm#Gt">Gt</a>'
to make the outer ridges transparent in 3-d.</p>

<p>For 2-d furthest-site Delaunay triangulations, Mathematica ('<a
href="qh-opto.htm#m">m</a>') displays the corresponding convex
hull (a paraboloid). </p>

<h3><a href="qh-opt.htm#opt"></a><a name="dQu-notes">furthest-site
Delaunay notes</a></h3>

<p>See <a href="qh-optv.htm#d-notes">Delaunay notes</a>.</p>

<h2><a href="qh-opt.htm#opt"></a><a name="vQu">Furthest-site
Voronoi diagram ('v Qu')</a></h2>

<p>The furthest-site Voronoi diagram is the furthest-neighbor map
for a set of points. See the survey article by Aurenhammer [<a
href="qh-man.htm#aure91">'91</a>] and a brief introduction by
O'Rourke [<a href="qh-man.htm#orou94">'94</a>]. </p>

<dl>
    <dt><b>Example:</b> rbox 10 D2 | qhull v Qu <a
        href="qh-optq.htm#QJn">QJ</a> <a href="qh-opto.htm#s">s</a>
        <a href="qh-opto.htm#o">o</a> <a href="qh-optt.htm#TO">TO
        result</a></dt>
    <dd>Compute the 2-d, furthest-site Voronoi diagram of 10
        random points. Joggle the input to guarantee triangular
        output. Write a summary to the console and the Voronoi
        regions and vertices to 'result'. The first vertex of the
        result indicates unbounded regions. Almost all regions are
        unbounded.</dd>
</dl>

<p>The furthest-site Voronoi diagram is the dual of the <a
href="qh-optv.htm#dQu">furthest-site Delaunay triangulation</a>.
Each furthest-site Voronoi vertex is the circumcenter of an upper
facet of the Delaunay triangulation. Each furthest-site Voronoi
region corresponds to a vertex of the Delaunay triangulation
(i.e., an input site). The correspondence skips interior input
sites.</p>

<p>Qhull outputs the furthest-site Voronoi vertices for each
furthest-site Voronoi region, and the ridge of the furthest-site
Voronoi diagram for each corresponding pair of input sites on the
convex hull.

<p>Most users should use 'qhull v Qu <a href="qh-optq.htm#QJn">QJ</a>'
or 'qhull v Qu <a href="qh-optq.htm#Qbb">Qbb</a>'. If you do not
use 'QJ', the output may include merged facets due to cocircular
or cospherical input sites. If you use 'QJ', duplicate points
will create small triangles. Without 'QJ', the output will report
nearly incident input sites. See <a href="qh-impre.htm#joggle">Joggled
input or merged facets</a>'. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="vQu-conventions"><font
size="4"> furthest-site Voronoi conventions</font></a></h3>

<p>The following terminology is used for furthest-site Voronoi
diagrams in Qhull. The underlying structure is a furthest-site
Delaunay triangulation from a convex hull in one higher
dimension. Upper facets of the Delaunay triangulation correspond
to vertices of the furthest-site Voronoi diagram. Vertices of the
furthest-site Delaunay triangulation correspond to input sites.
They also define regions of the furthest-site Voronoi diagram.
All vertices are extreme points of the input sites. See <a
href="qh-opt.htm#conventions">convex hull conventions</a> and <a
href="qh-optv.htm#dQu-conventions">furthest-site Delaunay
conventions</a>.</p>

<ul>
    <li><em>input site</em> - a point in the input (one dimension
        lower than a point on the convex hull)</li>
    <li><em>point</em> - <i>d+1</i> coordinates. The last
        coordinate is the sum of the squares of the input site's
        coordinates</li>
    <li><em>coplanar point</em> - a <em>nearly incident</em>
        input site</li>
    <li><em>vertex</em> - a point on the upper facets of the
        paraboloid. It corresponds to a unique input site. </li>
    <li><em>furthest-site Voronoi vertex</em> - the circumcenter
        of a furthest-site Delaunay facet</li>
    <li><em>furthest-site Voronoi region</em> - the region of
        Euclidean space further from an input site than any other
        input site. Qhull lists the furthest-site Voronoi
        vertices that define each furthest-site Voronoi region.</li>
    <li><em>furthest-site Voronoi diagram</em> - the graph of the
        furthest-site Voronoi regions with the ridges (edges)
        between the regions.</li>
    <li><em>infinity vertex</em> - the Voronoi vertex for
        unbounded furthest-site Voronoi regions in '<a
        href="qh-opto.htm#o">o</a>' output format. Its
        coordinates are <em>-10.101</em>.</li>
    <li><em>good facet</em> - an upper Delaunay facet with
        optional restrictions by '<a href="qh-optq.htm#QVn">QVn</a>',
        etc.</li>
</ul>

<h3><a href="qh-opt.htm#opt"></a><a name="vQu-outputs">furthest-site
Voronoi outputs</a></h3>

<p>These options control the output of furthest-site Voronoi
diagram. Other output options return the
corresponding furthest-site Delaunay triangulation.</p>

<dl compact>
    <dt>&nbsp;</dt>
    <dd><b>General</b></dd>
    <dt><a href="qh-opto.htm#s">s</a></dt>
    <dd>print summary for the furthest-site Voronoi diagram. Use
        '<a href="qh-optf.htm#Fs">Fs</a>' for the numbers.</dd>
    <dt><a href="qh-optq.htm#QVn">QVn</a> <a
        href="qh-optp.htm#Pg">Pg</a></dt>
    <dd>select furthest-site Voronoi vertices for input site <em>n</em>
    </dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>furthest-site Voronoi vertices</b></dd>
    <dt><a href="qh-optf.htm#Fn">Fn</a></dt>
    <dd>list neighboring furthest-site Voronoi vertices for each
        furthest-site Voronoi vertex</dd>
    <dt><a href="qh-optf.htm#Fv">Fv</a></dt>
    <dd>list ridges of Voronoi vertices for pairs of input sites.</dd>
    <dt><a href="qh-opto.htm#p">p</a></dt>
    <dd>print coordinates of the furthest-site Voronoi vertices.</dd>
    <dt><a href="#FC">FC</a></dt>
    <dd>print Voronoi vertex ("center") for each facet</dd>
    <dt>&nbsp;</dt>
    <dt>&nbsp;</dt>
    <dd><b>furthest-site Voronoi regions</b></dd>
    <dt><a href="qh-opto.htm#i">i</a></dt>
    <dd>list furthest-site Voronoi regions for each furthest-site
        Voronoi vertex</dd>
    <dt><a href="qh-optf.htm#FN">FN</a></dt>
    <dd>list furthest-site Voronoi vertices for each
        furthest-site Voronoi region</dd>
    <dt><a href="qh-opto.htm#o">o</a></dt>
    <dd>print coordinates of the furthest-site Voronoi vertices
        and list the furthest-site Voronoi vertices for each
        input site.</dd>
    <dt><a href="#Fi2">Fi</a></dt>
    <dd>print separating hyperplanes for inner, bounded Voronoi regions</dd>
    <dt><a href="#Fo2">Fo</a></dt>
    <dd>print separating hyperplanes for outer, unbounded Voronoi regions</dd>
</dl>

<p>For the '<a href="qh-opto.htm#o">o</a>' option, the first
number is the dimension. The next two numbers are the number of
vertices and the number of input sites. The line ends with a
&quot;1&quot;. The furthest-site Voronoi vertices are listed one
per line. The first (<em>0</em>'th) vertex indicates the infinity
vertex. Its coordinates are <em>-10.101</em>. The infinity vertex
also occurs for degenerate Delaunay triangles.</p>

<p>The furthest-site Voronoi regions follow the vertices with one
line per input site. Each region is defined by the number of
furthest-site Voronoi vertices followed by the index of each
vertex. Coplanar and interior input sites have &quot;0&quot;
vertices. In 2-d, the vertices are listed in adjacency order
(unoriented). In 3-d and higher, the vertices are listed in
numeric order. A zero index indicates the infinity vertex. Such
regions are unbounded.</p>

<p>For the '<a href="qh-optf.htm#Fv">Fv</a>' option, the first
line is the number of ridges.  The remaining lines list the number
of indices, a pair of input sites, and the corresponding ridge of
the furthest-site Voronoi diagram.  Vertex 0 indicates an unbounded ray.

<h3><a href="qh-opt.htm#opt"></a><a name="vQu-controls">furthest-site
Voronoi controls</a></h3>

<p>These options provide additional control:</p>

<dl compact>
    <dt><a href="qh-optq.htm#QJn">QJ</a></dt>
    <dd>joggle the input and set '<a href="qh-optq.htm#Qbb">Qbb</a>'
    </dd>
    <dt><a href="qh-opto.htm#f">f </a></dt>
    <dd>print the data structure for each facet</dd>
    <dt><a href="qh-optt.htm#TFn">TFn</a></dt>
    <dd>report progress after constructing <em>n</em> facets</dd>
    <dt><a href="qh-optq.htm#Qbb">Qbb</a></dt>
    <dd>scale the last coordinate to reduce precision errors. Use
        it for integer coefficients and nearly
        cocircular/cospherical input.</dd>
    <dt><a href="qh-optt.htm#Tv">Tv</a></dt>
    <dd>verify result</dd>
</dl>

<h3><a href="qh-opt.htm#opt"></a><a name="vQu-graphics">furthest-site
Voronoi graphics</a></h3>

<p>In 2-d, Geomview output ('<a href="qh-optg.htm#G">G</a>')
displays a furthest-site Voronoi diagram with extra edges to
close the unbounded furthest-site Voronoi regions.  All regions
will be unbounded!</p>

<p>See the <a href="qh-eg.htm#delaunay">Delaunay and Voronoi
examples</a> for a 2-d example. Turn off normalization (on
Geomview's 'obscure' menu) when comparing the furthest-site
Voronoi diagram with the corresponding Voronoi diagram. </p>

<h3><a href="qh-opt.htm#opt"></a><a name="vQu-notes">furthest-site
Voronoi notes</a></h3>

<p>See <a href="qh-optv.htm#v-notes">Voronoi notes</a>.</p>
<!-- Navigation links -->
<hr>

<p><b>Up:</b> <a href="http://www.geom.umn.edu/locate/qhull">Home
page for Qhull</a> <br>
<b>Up:</b> <a href="qh-man.htm#TOC">Qhull manual: Table of
Contents</a> <br>
<b>Up:</b> <a href="qh-opt.htm">Qhull options</a></p>

<p><b>To:</b> <a href="qh-man.htm#synopsis">Synopsis</a> &#149; <a
href="qh-opt.htm#opt">Main</a> &#149; <a
href="qh-opto.htm#output">Output</a> &#149; <a
href="qh-optf.htm#format">Formats</a> &#149; <a
href="qh-optg.htm#geomview">Geomview</a> &#149; <a
href="qh-optp.htm#print">Print</a> &#149; <a
href="qh-optq.htm#qhull">Qhull</a> &#149; <a
href="qh-optc.htm#prec">Precision</a> &#149; <a
href="qh-optt.htm#trace">Trace</a></p>
<!-- GC common information -->
<hr>

<p><a href="http://www.geom.umn.edu/"><img src="qh--geom.gif"
align="middle" width="40" height="40"></a><i>The Geometry Center
Home Page </i></p>

<p>Comments to: <a
href="http://www.geom.umn.edu/software/qhull/qhull-mail.html">qhull@geom.umn.edu
</a><br>
Created: Sept. 25, 1995 --- <!-- hhmts start --> Last modified: see top <!-- hhmts end --> </p>
</body>
</html>
